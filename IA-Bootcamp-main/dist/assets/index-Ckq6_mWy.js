var C=r=>{throw TypeError(r)};var S=(r,e,s)=>e.has(r)||C("Cannot "+s);var a=(r,e,s)=>(S(r,e,"read from private field"),s?s.call(r):e.get(r)),y=(r,e,s)=>e.has(r)?C("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,s),j=(r,e,s,i)=>(S(r,e,"write to private field"),i?i.call(r,s):e.set(r,s),s),v=(r,e,s)=>(S(r,e,"access private method"),s);import{S as D,s as k,h as M,g as P,n as U,u as R,r as p,a as K,b as L,j as t}from"./index-CxBgTKmc.js";var x,b,l,c,d,N,E,O,T=(O=class extends D{constructor(e,s){super();y(this,d);y(this,x);y(this,b);y(this,l);y(this,c);j(this,x,e),this.setOptions(s),this.bindMethods(),v(this,d,N).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var i;const s=this.options;this.options=a(this,x).defaultMutationOptions(e),k(this.options,s)||a(this,x).getMutationCache().notify({type:"observerOptionsUpdated",mutation:a(this,l),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&M(s.mutationKey)!==M(this.options.mutationKey)?this.reset():((i=a(this,l))==null?void 0:i.state.status)==="pending"&&a(this,l).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=a(this,l))==null||e.removeObserver(this)}onMutationUpdate(e){v(this,d,N).call(this),v(this,d,E).call(this,e)}getCurrentResult(){return a(this,b)}reset(){var e;(e=a(this,l))==null||e.removeObserver(this),j(this,l,void 0),v(this,d,N).call(this),v(this,d,E).call(this)}mutate(e,s){var i;return j(this,c,s),(i=a(this,l))==null||i.removeObserver(this),j(this,l,a(this,x).getMutationCache().build(a(this,x),this.options)),a(this,l).addObserver(this),a(this,l).execute(e)}},x=new WeakMap,b=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakSet,N=function(){var s;const e=((s=a(this,l))==null?void 0:s.state)??P();j(this,b,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},E=function(e){U.batch(()=>{var s,i,o,g,u,n,h,m;if(a(this,c)&&this.hasListeners()){const f=a(this,b).variables,w=a(this,b).context;(e==null?void 0:e.type)==="success"?((i=(s=a(this,c)).onSuccess)==null||i.call(s,e.data,f,w),(g=(o=a(this,c)).onSettled)==null||g.call(o,e.data,null,f,w)):(e==null?void 0:e.type)==="error"&&((n=(u=a(this,c)).onError)==null||n.call(u,e.error,f,w),(m=(h=a(this,c)).onSettled)==null||m.call(h,void 0,e.error,f,w))}this.listeners.forEach(f=>{f(a(this,b))})})},O);function $(r,e){const s=R(),[i]=p.useState(()=>new T(s,r));p.useEffect(()=>{i.setOptions(r)},[i,r]);const o=p.useSyncExternalStore(p.useCallback(u=>i.subscribe(U.batchCalls(u)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),g=p.useCallback((u,n)=>{i.mutate(u,n).catch(K)},[i]);if(o.error&&L(i.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:g,mutateAsync:o.mutate}}async function A(r){const e=await fetch("http://localhost:3000/api/chat/completions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:r})});if(!e.ok)throw new Error("Error al enviar mensaje");const s=await e.json();return{message:s.message||s.content||"Sin respuesta"}}function I(){const[r,e]=p.useState([]),[s,i]=p.useState(""),o=$({mutationFn:A,onSuccess:n=>{const h={id:Date.now().toString()+"-bot",content:n.message,isUser:!1,timestamp:new Date};e(m=>[...m,h])},onError:n=>{const h={id:Date.now().toString()+"-error",content:`❌ Error: ${n.message}`,isUser:!1,timestamp:new Date};e(m=>[...m,h])}}),g=n=>{if(n.preventDefault(),!s.trim()||o.isPending)return;const h={id:Date.now().toString(),content:s,isUser:!0,timestamp:new Date};e(m=>[...m,h]),o.mutate(s),i("")},u=()=>{e([])};return t.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[t.jsxs("div",{className:"bg-white border-b border-gray-200 p-4 flex items-center justify-between shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-2xl",children:"🤖"}),t.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"Chat Assistant"})]}),t.jsx("button",{onClick:u,className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors flex items-center gap-1",children:"🗑️ Limpiar"})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r.length===0?t.jsxs("div",{className:"text-center text-gray-500 mt-20",children:[t.jsx("span",{className:"text-4xl block mb-2",children:"💬"}),t.jsx("p",{children:"¡Hola! Escribe un mensaje para comenzar."})]}):r.map(n=>t.jsx("div",{className:`flex ${n.isUser?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:"flex items-start gap-2 max-w-xs md:max-w-md lg:max-w-lg",children:[!n.isUser&&t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:"🤖"}),t.jsxs("div",{className:`px-4 py-2 rounded-lg ${n.isUser?"bg-blue-500 text-white rounded-br-sm":"bg-white border border-gray-200 rounded-bl-sm"}`,children:[t.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:n.content}),t.jsx("p",{className:`text-xs mt-1 ${n.isUser?"text-blue-100":"text-gray-500"}`,children:n.timestamp.toLocaleTimeString()})]}),n.isUser&&t.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:"👤"})]})},n.id)),o.isPending&&t.jsx("div",{className:"flex justify-start",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:"🤖"}),t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg rounded-bl-sm px-4 py-2",children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Escribiendo"}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce"}),t.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),t.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})]})})]}),t.jsx("div",{className:"bg-white border-t border-gray-200 p-4",children:t.jsxs("form",{onSubmit:g,className:"flex gap-2",children:[t.jsx("input",{type:"text",value:s,onChange:n=>i(n.target.value),placeholder:"Escribe tu mensaje...",disabled:o.isPending,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100"}),t.jsxs("button",{type:"submit",disabled:!s.trim()||o.isPending,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-1",children:[t.jsx("span",{children:"📤"}),"Enviar"]})]})})]})}function z(){return t.jsx(I,{})}export{z as component};
