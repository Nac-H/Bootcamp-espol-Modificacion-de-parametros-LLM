var M=s=>{throw TypeError(s)};var S=(s,e,t)=>e.has(s)||M("Cannot "+t);var o=(s,e,t)=>(S(s,e,"read from private field"),t?t.call(s):e.get(s)),y=(s,e,t)=>e.has(s)?M("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),v=(s,e,t,i)=>(S(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),j=(s,e,t)=>(S(s,e,"access private method"),t);import{S as T,s as U,h as C,g as _,n as K,u as k,r as x,a as D,b as R,j as r}from"./index-L2jjGgjH.js";var g,f,l,m,b,N,E,P,L=(P=class extends T{constructor(e,t){super();y(this,b);y(this,g);y(this,f);y(this,l);y(this,m);v(this,g,e),this.setOptions(t),this.bindMethods(),j(this,b,N).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var i;const t=this.options;this.options=o(this,g).defaultMutationOptions(e),U(this.options,t)||o(this,g).getMutationCache().notify({type:"observerOptionsUpdated",mutation:o(this,l),observer:this}),t!=null&&t.mutationKey&&this.options.mutationKey&&C(t.mutationKey)!==C(this.options.mutationKey)?this.reset():((i=o(this,l))==null?void 0:i.state.status)==="pending"&&o(this,l).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=o(this,l))==null||e.removeObserver(this)}onMutationUpdate(e){j(this,b,N).call(this),j(this,b,E).call(this,e)}getCurrentResult(){return o(this,f)}reset(){var e;(e=o(this,l))==null||e.removeObserver(this),v(this,l,void 0),j(this,b,N).call(this),j(this,b,E).call(this)}mutate(e,t){var i;return v(this,m,t),(i=o(this,l))==null||i.removeObserver(this),v(this,l,o(this,g).getMutationCache().build(o(this,g),this.options)),o(this,l).addObserver(this),o(this,l).execute(e)}},g=new WeakMap,f=new WeakMap,l=new WeakMap,m=new WeakMap,b=new WeakSet,N=function(){var t;const e=((t=o(this,l))==null?void 0:t.state)??_();v(this,f,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},E=function(e){K.batch(()=>{var t,i,a,d,h,c,w,n;if(o(this,m)&&this.hasListeners()){const u=o(this,f).variables,p=o(this,f).context;(e==null?void 0:e.type)==="success"?((i=(t=o(this,m)).onSuccess)==null||i.call(t,e.data,u,p),(d=(a=o(this,m)).onSettled)==null||d.call(a,e.data,null,u,p)):(e==null?void 0:e.type)==="error"&&((c=(h=o(this,m)).onError)==null||c.call(h,e.error,u,p),(n=(w=o(this,m)).onSettled)==null||n.call(w,void 0,e.error,u,p))}this.listeners.forEach(u=>{u(o(this,f))})})},P);function $(s,e){const t=k(),[i]=x.useState(()=>new L(t,s));x.useEffect(()=>{i.setOptions(s)},[i,s]);const a=x.useSyncExternalStore(x.useCallback(h=>i.subscribe(K.batchCalls(h)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),d=x.useCallback((h,c)=>{i.mutate(h,c).catch(D)},[i]);if(a.error&&R(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:d,mutateAsync:a.mutate}}function O(s,e,t){return Math.min(Math.max(s,e),t)}function A(s){if(s==="")return;const e=Number(s);return Number.isFinite(e)?e:void 0}async function I(s,e){const t={input:s,messages:[{role:"user",content:s}],params:{temperature:e.temperature,top_p:e.top_p,top_k:e.top_k,reasoning_effort:e.reasoning_effort}},i=await fetch("http://localhost:3000/api/completion",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await i.text();if(!i.ok)throw new Error(`HTTP ${i.status} ${a}`);try{const d=JSON.parse(a);return{message:d.message||d.content||"Sin respuesta"}}catch{return{message:a||"Sin respuesta"}}}function q(){const[s,e]=x.useState([]),[t,i]=x.useState(""),[a,d]=x.useState({temperature:"0.7",topP:"",topK:"",reasoningEffort:"medium"}),h={temperature:A(a.temperature),reasoning_effort:a.reasoningEffort};a.topP&&!a.topK&&(h.top_p=O(Number(a.topP),0,1)),a.topK&&!a.topP&&(h.top_k=O(Number(a.topK),0,20));const c=$({mutationFn:n=>I(n,h),retry:!1,onSuccess:n=>{const u={id:Date.now().toString()+"-bot",content:n.message,isUser:!1,timestamp:new Date};e(p=>[...p,u])},onError:n=>{const u={id:Date.now().toString()+"-error",content:`❌ Error: ${n.message}`,isUser:!1,timestamp:new Date};e(p=>[...p,u])}}),w=n=>{if(n.preventDefault(),!t.trim()||c.isPending)return;const u={id:Date.now().toString(),content:t,isUser:!0,timestamp:new Date};e(p=>[...p,u]),c.mutate(t),i("")};return r.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[r.jsxs("div",{className:"bg-white border-b border-gray-200 p-4 flex items-center justify-between shadow-sm",children:[r.jsx("h1",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:"🤖 Chat Assistant"}),r.jsx("button",{onClick:()=>e([]),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-md",children:"🗑️ Limpiar"})]}),r.jsxs("div",{className:"bg-white border-b border-gray-200 p-4 grid grid-cols-2 md:grid-cols-4 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Temperature (0-1)"}),r.jsx("input",{type:"number",min:0,max:1,step:.1,value:a.temperature,onChange:n=>d(u=>({...u,temperature:n.target.value})),className:"w-full px-2 py-1 border rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Top-p (0-1)"}),r.jsx("input",{type:"number",min:0,max:1,step:.01,value:a.topP,onChange:n=>d(u=>({...u,topP:n.target.value})),disabled:!!a.topK,className:"w-full px-2 py-1 border rounded disabled:bg-gray-100"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Top-k (0-20)"}),r.jsx("input",{type:"number",min:0,max:20,step:1,value:a.topK,onChange:n=>d(u=>({...u,topK:n.target.value})),disabled:!!a.topP,className:"w-full px-2 py-1 border rounded disabled:bg-gray-100"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-gray-600",children:"Reasoning Effort"}),r.jsxs("select",{value:a.reasoningEffort,onChange:n=>d(u=>({...u,reasoningEffort:n.target.value})),className:"w-full px-2 py-1 border rounded",children:[r.jsx("option",{value:"high",children:"High"}),r.jsx("option",{value:"medium",children:"Medium"}),r.jsx("option",{value:"low",children:"Low"}),r.jsx("option",{value:"minimal",children:"Minimal"})]})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[s.map(n=>r.jsx("div",{className:`flex ${n.isUser?"justify-end":"justify-start"}`,children:r.jsxs("div",{className:`px-4 py-2 rounded-lg ${n.isUser?"bg-blue-500 text-white":"bg-white border border-gray-200"}`,children:[r.jsx("p",{children:n.content}),r.jsx("p",{className:"text-xs mt-1 text-gray-400",children:n.timestamp.toLocaleTimeString()})]})},n.id)),c.isPending&&r.jsx("div",{className:"text-sm text-gray-500",children:"🤖 Escribiendo..."})]}),r.jsx("div",{className:"bg-white border-t border-gray-200 p-4",children:r.jsxs("form",{onSubmit:w,className:"flex gap-2",children:[r.jsx("input",{type:"text",value:t,onChange:n=>i(n.target.value),placeholder:"Escribe tu mensaje...",disabled:c.isPending,className:"flex-1 px-3 py-2 border rounded"}),r.jsx("button",{type:"submit",disabled:!t.trim()||c.isPending,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:"Enviar"})]})})]})}function J(){return r.jsx(q,{})}export{J as component};
